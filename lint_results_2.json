[{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\api\\artist\\artwork\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\api\\artwork\\[id]\\like\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1682,1685],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1682,1685],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/lib/auth\";\r\nimport prisma from \"@/lib/prisma\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nexport async function POST(\r\n    req: Request,\r\n    { params }: { params: Promise<{ id: string }> }\r\n) {\r\n    try {\r\n        const { id: artworkId } = await params;\r\n        const session = await getServerSession(authOptions);\r\n\r\n        if (!session || !session.user?.email) {\r\n            return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n        const user = await prisma.user.findUnique({\r\n            where: { email: session.user.email }\r\n        });\r\n\r\n        if (!user) {\r\n            return NextResponse.json({ message: \"User not found\" }, { status: 404 });\r\n        }\r\n\r\n        const existingLike = await prisma.like.findUnique({\r\n            where: {\r\n                userId_artworkId: {\r\n                    userId: user.id,\r\n                    artworkId: artworkId,\r\n                },\r\n            },\r\n        });\r\n\r\n        if (existingLike) {\r\n            await prisma.like.delete({\r\n                where: {\r\n                    userId_artworkId: {\r\n                        userId: user.id,\r\n                        artworkId: artworkId,\r\n                    },\r\n                },\r\n            });\r\n            return NextResponse.json({ message: \"Unliked\" });\r\n        } else {\r\n            await prisma.like.create({\r\n                data: {\r\n                    userId: user.id,\r\n                    artworkId: artworkId,\r\n                },\r\n            });\r\n            return NextResponse.json({ message: \"Liked\" });\r\n        }\r\n    } catch (error: any) {\r\n        return NextResponse.json(\r\n            { message: \"Error toggling like\", error: error.message },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\api\\auth\\[...nextauth]\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\api\\auth\\register\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1171,1174],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1171,1174],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextResponse } from \"next/server\";\r\nimport bcrypt from \"bcryptjs\";\r\nimport prisma from \"@/lib/prisma\";\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { name, email, password } = await req.json();\r\n\r\n        if (!email || !password) {\r\n            return NextResponse.json(\r\n                { message: \"Missing email or password\" },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const existingUser = await prisma.user.findUnique({\r\n            where: { email }\r\n        });\r\n\r\n        if (existingUser) {\r\n            return NextResponse.json(\r\n                { message: \"User already exists\" },\r\n                { status: 400 }\r\n            );\r\n        }\r\n\r\n        const hashedPassword = await bcrypt.hash(password, 10);\r\n\r\n        const user = await prisma.user.create({\r\n            data: {\r\n                name,\r\n                email,\r\n                password: hashedPassword,\r\n            }\r\n        });\r\n\r\n        return NextResponse.json(\r\n            { message: \"User registered successfully\", user: { id: user.id, email: user.email } },\r\n            { status: 201 }\r\n        );\r\n    } catch (error: any) {\r\n        return NextResponse.json(\r\n            { message: \"Error registering user\", error: error.message },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\api\\user\\preferences\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[995,998],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[995,998],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":103,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3699,3702],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3699,3702],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getServerSession } from \"next-auth\";\r\nimport { authOptions } from \"@/lib/auth\";\r\nimport prisma from \"@/lib/prisma\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\nexport async function PUT(req: Request) {\r\n    try {\r\n        const session = await getServerSession(authOptions);\r\n        const body = await req.json();\r\n\r\n        if (!session || !session.user?.email) {\r\n            return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const updatedUser = await prisma.user.update({\r\n            where: { email: session.user.email },\r\n            data: {\r\n                role: body.role,\r\n                onboarded: true,\r\n                preferences: {\r\n                    context: body.context,\r\n                    budget: body.budget,\r\n                    styles: body.styles,\r\n                },\r\n            },\r\n        });\r\n\r\n        return NextResponse.json({ message: \"Preferences updated\", user: updatedUser });\r\n    } catch (error: any) {\r\n        return NextResponse.json(\r\n            { message: \"Error updating preferences\", error: error.message },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n\r\nexport async function GET() {\r\n    try {\r\n        const session = await getServerSession(authOptions);\r\n        if (!session?.user?.email) {\r\n            return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 });\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({\r\n            where: { email: session.user.email },\r\n            include: { likes: true }\r\n        });\r\n\r\n        if (!user || !user.preferences) {\r\n            return NextResponse.json({ message: \"No preferences found\" }, { status: 404 });\r\n        }\r\n\r\n        const preferences = user.preferences as { budget: string; styles: string[] };\r\n        const searchStyles = preferences.styles.map(s => s.toLowerCase());\r\n\r\n        // Parse Price Range\r\n        const budgetStr = preferences.budget.replace(/[\\$,]/g, \"\"); \r\n        let minPrice = 0, maxPrice = 1000000;\r\n\r\n        if (budgetStr.includes(\"-\")) {\r\n            const parts = budgetStr.split(\"-\");\r\n            minPrice = parseInt(parts[0]) || 0;\r\n            maxPrice = parseInt(parts[1]) || 1000000;\r\n        } else if (budgetStr.includes(\"+\")) {\r\n            minPrice = parseInt(budgetStr) || 0;\r\n        }\r\n\r\n        // Fetch Artworks with Join\r\n        const artworks = await prisma.artwork.findMany({\r\n            where: {\r\n                OR: [\r\n                    // 1. Check for exact matches in tags\r\n                    { tags: { hasSome: searchStyles } },\r\n                    // 2. Fuzzy search: Check if any style is contained in the title or medium\r\n                    ...searchStyles.map(style => ({\r\n                        title: { contains: style, mode: 'insensitive' as const }\r\n                    }))\r\n                ],\r\n                // Only apply price filter if explicitly set\r\n                price: { gte: minPrice, lte: maxPrice }\r\n            },\r\n            include: {\r\n                artist: { select: { name: true } },\r\n                likes: true\r\n            }\r\n        });\r\n\r\n        const likedIds = user.likes.map(l => l.artworkId);\r\n\r\n        // Map data to a \"Flat\" structure for the frontend\r\n        const formattedArtworks = artworks.map(art => ({\r\n            ...art,\r\n            artistName: art.artist?.name || \"Independent Artist\",\r\n            isLiked: likedIds.includes(art.id),\r\n            likesCount: art.likes.length\r\n        }));\r\n\r\n        return NextResponse.json({\r\n            artworks: formattedArtworks,\r\n            userStyles: preferences.styles // Send back for the UI header\r\n        });\r\n\r\n    } catch (error: any) {\r\n        return NextResponse.json({ message: error.message }, { status: 500 });\r\n    }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\artist\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\login\\page.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\login\\page.tsx:23:13\n  21 |         const registered = searchParams.get(\"registered\");\n  22 |         if (registered) {\n> 23 |             setSuccess(\"Account created successfully! Please sign in.\");\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  24 |         }\n  25 |     }, [searchParams]);\n  26 |","line":23,"column":13,"nodeType":null,"endLine":23,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\";\r\n\r\nimport { useState, useEffect, Suspense } from \"react\";\r\nimport { signIn } from \"next-auth/react\";\r\nimport { useRouter, useSearchParams } from \"next/navigation\";\r\nimport { getSession } from \"next-auth/react\";\r\nimport Link from \"next/link\";\r\n\r\nfunction LoginForm() {\r\n    const router = useRouter();\r\n    const searchParams = useSearchParams();\r\n    const [formData, setFormData] = useState({\r\n        email: \"\",\r\n        password: \"\",\r\n    });\r\n    const [error, setError] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n    const [success, setSuccess] = useState(\"\");\r\n\r\n    useEffect(() => {\r\n        const registered = searchParams.get(\"registered\");\r\n        if (registered) {\r\n            setSuccess(\"Account created successfully! Please sign in.\");\r\n        }\r\n    }, [searchParams]);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        setError(\"\");\r\n\r\n        const res = await signIn(\"credentials\", {\r\n            email: formData.email,\r\n            password: formData.password,\r\n            redirect: false,\r\n        });\r\n\r\n        if (res?.error) {\r\n            setError(\"Invalid email or password\");\r\n            setLoading(false);\r\n        } else {\r\n            const session = await getSession();\r\n            if (!session?.user) {\r\n                router.push(\"/dashboard\");\r\n                return;\r\n            }\r\n\r\n            if (!session.user.onboarded) {\r\n                router.push(\"/onboarding\");\r\n            } else {\r\n                // Check the role and route accordingly\r\n                const userRole = session.user.role;\r\n                if (userRole === \"ARTIST\") {\r\n                    router.push(\"/artist/dashboard\");\r\n                } else {\r\n                    router.push(\"/dashboard\");\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"w-full max-w-md space-y-8\">\r\n            <div>\r\n                <h2 className=\"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900\">\r\n                    Sign in to Art Curator\r\n                </h2>\r\n            </div>\r\n            <form className=\"mt-8 space-y-6\" onSubmit={handleSubmit}>\r\n                <div className=\"-space-y-px rounded-md shadow-sm\">\r\n                    <div>\r\n                        <input\r\n                            type=\"email\"\r\n                            required\r\n                            className=\"relative block w-full rounded-t-md border-0 py-1.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:z-10 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 px-3\"\r\n                            placeholder=\"Email address\"\r\n                            value={formData.email}\r\n                            onChange={(e) => setFormData({ ...formData, email: e.target.value })}\r\n                        />\r\n                    </div>\r\n                    <div>\r\n                        <input\r\n                            type=\"password\"\r\n                            required\r\n                            className=\"relative block w-full rounded-b-md border-0 py-1.5 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:z-10 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 px-3\"\r\n                            placeholder=\"Password\"\r\n                            value={formData.password}\r\n                            onChange={(e) => setFormData({ ...formData, password: e.target.value })}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {success && <p className=\"text-sm text-green-600 font-medium text-center\">{success}</p>}\r\n                {error && <p className=\"text-sm text-red-600 font-medium text-center\">{error}</p>}\r\n\r\n                <div>\r\n                    <button\r\n                        type=\"submit\"\r\n                        disabled={loading}\r\n                        className=\"group relative flex w-full justify-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:bg-indigo-400\"\r\n                    >\r\n                        {loading ? \"Signing in...\" : \"Sign in\"}\r\n                    </button>\r\n                </div>\r\n            </form>\r\n            <div className=\"text-center\">\r\n                <p className=\"text-sm text-gray-600\">\r\n                    Don&apos;t have an account?{\" \"}\r\n                    <Link href=\"/register\" className=\"font-medium text-indigo-600 hover:text-indigo-500\">\r\n                        Sign up\r\n                    </Link>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function LoginPage() {\r\n    return (\r\n        <div className=\"flex min-h-screen items-center justify-center bg-gray-50 px-4 py-12 sm:px-6 lg:px-8\">\r\n            <Suspense fallback={<div>Loading...</div>}>\r\n                <LoginForm />\r\n            </Suspense>\r\n        </div>\r\n    );\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\onboarding\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\preferences\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\app\\register\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\components\\providers\\SessionProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\components\\ui\\ArtCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\components\\ui\\Navbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\lib\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\lib\\prisma.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\middleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\NUS\\PINUSHACK\\recommendation-system\\src\\types\\next-auth.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[230,233],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[230,233],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { DefaultSession } from \"next-auth\";\r\n\r\ndeclare module \"next-auth\" {\r\n    interface Session {\r\n        user: {\r\n            id: string;\r\n            role: string;\r\n            onboarded: boolean;\r\n            preferences?: any;\r\n        } & DefaultSession[\"user\"];\r\n    }\r\n\r\n    interface User {\r\n        role: string;\r\n        onboarded: boolean;\r\n    }\r\n}\r\n\r\ndeclare module \"next-auth/jwt\" {\r\n    interface JWT {\r\n        id: string;\r\n        role: string;\r\n        onboarded: boolean;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]}]